{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\mende\\\\Documents\\\\Angular\\\\FerreteriaDonPepe\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { USUARIOS } from './Misusuarios';\nimport firebase from 'firebase/compat/app';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nexport class SharedService {\n  constructor(firestore, afauth) {\n    this.firestore = firestore;\n    this.afauth = afauth;\n    this.user = USUARIOS;\n    this.getAuthUid();\n  }\n\n  getuser() {\n    return this.user;\n  }\n\n  settam(tam, posicion) {\n    this.user[posicion].tam = tam;\n  } //CRUD\n\n\n  addArticle(article) {\n    return this.firestore.collection('articles').add(article);\n  }\n\n  getArticles() {\n    return this.firestore.collection('articles', ref => ref.orderBy('name', 'asc')).snapshotChanges();\n  }\n\n  deleteArticle(id) {\n    return this.firestore.collection('articles').doc(id).delete();\n  }\n\n  getArticle(id) {\n    return this.firestore.collection('articles').doc(id).snapshotChanges();\n  }\n\n  updateArticle(id, data) {\n    return this.firestore.collection('articles').doc(id).update(data);\n  } //USUARIOS\n\n\n  createDoc(data, path, id) {\n    const collection = this.firestore.collection(path);\n    return collection.doc(id).set(data);\n  }\n\n  getDoc(path, id) {\n    const collection = this.firestore.collection(path);\n    return collection.doc(id).valueChanges;\n  }\n\n  deleteDoc(path, id) {\n    const collection = this.firestore.collection(path);\n    return collection.doc(id).delete;\n  }\n\n  updateDoc(data, path, id) {\n    const collection = this.firestore.collection(path);\n    return collection.doc(id).update(data);\n  }\n\n  getUid() {\n    return this.firestore.createId();\n  }\n\n  getCollection(path) {\n    const collection = this.firestore.collection(path);\n    return collection.valueChanges;\n  } //AUTENTICACION\n\n\n  register(email, password) {\n    return this.afauth.createUserWithEmailAndPassword(email, password);\n  } //   login(email: string, password:string){\n  //     return this.afauth.signInWithEmailAndPassword(email,password);\n  // }\n\n\n  login(email, password) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        return yield _this.afauth.signInWithEmailAndPassword(email, password);\n      } catch (err) {\n        console.log(\"error en login:  \", err);\n        return null;\n      }\n    })();\n  }\n\n  logout() {\n    return this.afauth.signOut();\n  }\n\n  getAuthUid() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const user = yield _this2.afauth.currentUser;\n\n      if (user === null) {\n        return null;\n      } else {\n        return user.uid;\n      }\n    })();\n  }\n\n  stateAuth() {\n    return this.afauth.authState;\n  } //tele\n\n\n  mandarCodigo(numero, appVerified) {\n    return this.afauth.signInWithPhoneNumber(numero, appVerified).then(confirmation => {\n      window.confirmationResult = confirmation;\n      alert(\"LISTO\");\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  verificarCodigo(codigo) {\n    return window.confirmationResult.confirm(codigo).then(result => {\n      let credenciales = firebase.auth.PhoneAuthProvider.credential(window.confirmationResult.verificationId, codigo);\n      this.afauth.signInWithCredential(credenciales);\n    });\n  }\n\n}\n\nSharedService.ɵfac = function SharedService_Factory(t) {\n  return new (t || SharedService)(i0.ɵɵinject(i1.AngularFirestore), i0.ɵɵinject(i2.AngularFireAuth));\n};\n\nSharedService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: SharedService,\n  factory: SharedService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["C:/Users/mende/Documents/Angular/FerreteriaDonPepe/src/app/shared.service.ts"],"names":["USUARIOS","firebase","i0","i1","i2","SharedService","constructor","firestore","afauth","user","getAuthUid","getuser","settam","tam","posicion","addArticle","article","collection","add","getArticles","ref","orderBy","snapshotChanges","deleteArticle","id","doc","delete","getArticle","updateArticle","data","update","createDoc","path","set","getDoc","valueChanges","deleteDoc","updateDoc","getUid","createId","getCollection","register","email","password","createUserWithEmailAndPassword","login","signInWithEmailAndPassword","err","console","log","logout","signOut","currentUser","uid","stateAuth","authState","mandarCodigo","numero","appVerified","signInWithPhoneNumber","then","confirmation","window","confirmationResult","alert","catch","verificarCodigo","codigo","confirm","result","credenciales","auth","PhoneAuthProvider","credential","verificationId","signInWithCredential","ɵfac","SharedService_Factory","t","ɵɵinject","AngularFirestore","AngularFireAuth","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { USUARIOS } from './Misusuarios';\r\nimport firebase from 'firebase/compat/app';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/fire/compat/firestore\";\r\nimport * as i2 from \"@angular/fire/compat/auth\";\r\nexport class SharedService {\r\n    constructor(firestore, afauth) {\r\n        this.firestore = firestore;\r\n        this.afauth = afauth;\r\n        this.user = USUARIOS;\r\n        this.getAuthUid();\r\n    }\r\n    getuser() {\r\n        return this.user;\r\n    }\r\n    settam(tam, posicion) {\r\n        this.user[posicion].tam = tam;\r\n    }\r\n    //CRUD\r\n    addArticle(article) {\r\n        return this.firestore.collection('articles').add(article);\r\n    }\r\n    getArticles() {\r\n        return this.firestore.collection('articles', ref => ref.orderBy('name', 'asc')).snapshotChanges();\r\n    }\r\n    deleteArticle(id) {\r\n        return this.firestore.collection('articles').doc(id).delete();\r\n    }\r\n    getArticle(id) {\r\n        return this.firestore.collection('articles').doc(id).snapshotChanges();\r\n    }\r\n    updateArticle(id, data) {\r\n        return this.firestore.collection('articles').doc(id).update(data);\r\n    }\r\n    //USUARIOS\r\n    createDoc(data, path, id) {\r\n        const collection = this.firestore.collection(path);\r\n        return collection.doc(id).set(data);\r\n    }\r\n    getDoc(path, id) {\r\n        const collection = this.firestore.collection(path);\r\n        return collection.doc(id).valueChanges;\r\n    }\r\n    deleteDoc(path, id) {\r\n        const collection = this.firestore.collection(path);\r\n        return collection.doc(id).delete;\r\n    }\r\n    updateDoc(data, path, id) {\r\n        const collection = this.firestore.collection(path);\r\n        return collection.doc(id).update(data);\r\n    }\r\n    getUid() {\r\n        return this.firestore.createId();\r\n    }\r\n    getCollection(path) {\r\n        const collection = this.firestore.collection(path);\r\n        return collection.valueChanges;\r\n    }\r\n    //AUTENTICACION\r\n    register(email, password) {\r\n        return this.afauth.createUserWithEmailAndPassword(email, password);\r\n    }\r\n    //   login(email: string, password:string){\r\n    //     return this.afauth.signInWithEmailAndPassword(email,password);\r\n    // }\r\n    async login(email, password) {\r\n        try {\r\n            return await this.afauth.signInWithEmailAndPassword(email, password);\r\n        }\r\n        catch (err) {\r\n            console.log(\"error en login:  \", err);\r\n            return null;\r\n        }\r\n    }\r\n    logout() {\r\n        return this.afauth.signOut();\r\n    }\r\n    async getAuthUid() {\r\n        const user = await this.afauth.currentUser;\r\n        if (user === null) {\r\n            return null;\r\n        }\r\n        else {\r\n            return user.uid;\r\n        }\r\n    }\r\n    stateAuth() {\r\n        return this.afauth.authState;\r\n    }\r\n    //tele\r\n    mandarCodigo(numero, appVerified) {\r\n        return this.afauth.signInWithPhoneNumber(numero, appVerified).then(confirmation => {\r\n            window.confirmationResult = confirmation;\r\n            alert(\"LISTO\");\r\n        }).catch(err => {\r\n            console.log(err);\r\n        });\r\n    }\r\n    verificarCodigo(codigo) {\r\n        return window.confirmationResult.confirm(codigo).then((result) => {\r\n            let credenciales = firebase.auth.PhoneAuthProvider.credential(window.confirmationResult.verificationId, codigo);\r\n            this.afauth.signInWithCredential(credenciales);\r\n        });\r\n    }\r\n}\r\nSharedService.ɵfac = function SharedService_Factory(t) { return new (t || SharedService)(i0.ɵɵinject(i1.AngularFirestore), i0.ɵɵinject(i2.AngularFireAuth)); };\r\nSharedService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SharedService, factory: SharedService.ɵfac, providedIn: 'root' });\r\n"]},"metadata":{},"sourceType":"module"}